/* SPDX-License-Identifier: BSD-3-Clause */
/* Copyright (c) 2023 - Present Romain Augier */
/* All rights reserved. */

#include "libromano/fmt.h"

#include <string.h>

int main(void)
{
    ROMANO_ASSERT(fmt_size_i64(0) == 1, "");
    ROMANO_ASSERT(fmt_size_i64(-33805341LL) == 9, "fmt_size_i64(-33805341) should be 9");
    ROMANO_ASSERT(fmt_size_i64(673859467480121164LL) == 18, "fmt_size_i64(673859467480121164) should be 18");
    ROMANO_ASSERT(fmt_size_i64(-269005187LL) == 10, "fmt_size_i64(-269005187) should be 10");
    ROMANO_ASSERT(fmt_size_i64(31592483594025970LL) == 17, "fmt_size_i64(31592483594025970) should be 17");
    ROMANO_ASSERT(fmt_size_i64(8LL) == 1, "fmt_size_i64(8) should be 1");
    ROMANO_ASSERT(fmt_size_i64(115725773LL) == 9, "fmt_size_i64(115725773) should be 9");
    ROMANO_ASSERT(fmt_size_i64(-69104LL) == 6, "fmt_size_i64(-69104) should be 6");
    ROMANO_ASSERT(fmt_size_i64(2022529918864LL) == 13, "fmt_size_i64(2022529918864) should be 13");
    ROMANO_ASSERT(fmt_size_i64(-4741241744LL) == 11, "fmt_size_i64(-4741241744) should be 11");
    ROMANO_ASSERT(fmt_size_i64(11904709690LL) == 11, "fmt_size_i64(11904709690) should be 11");
    ROMANO_ASSERT(fmt_size_i64(33154851584LL) == 11, "fmt_size_i64(33154851584) should be 11");
    ROMANO_ASSERT(fmt_size_i64(-1892176LL) == 8, "fmt_size_i64(-1892176) should be 8");
    ROMANO_ASSERT(fmt_size_i64(-123129125LL) == 10, "fmt_size_i64(-123129125) should be 10");
    ROMANO_ASSERT(fmt_size_i64(2109LL) == 4, "fmt_size_i64(2109) should be 4");
    ROMANO_ASSERT(fmt_size_i64(-796456678LL) == 10, "fmt_size_i64(-796456678) should be 10");
    ROMANO_ASSERT(fmt_size_i64(-4213137916926289LL) == 17, "fmt_size_i64(-4213137916926289) should be 17");
    ROMANO_ASSERT(fmt_size_i64(1142510LL) == 7, "fmt_size_i64(1142510) should be 7");
    ROMANO_ASSERT(fmt_size_i64(0LL) == 1, "fmt_size_i64(0) should be 1");
    ROMANO_ASSERT(fmt_size_i64(-471LL) == 4, "fmt_size_i64(-471) should be 4");
    ROMANO_ASSERT(fmt_size_i64(6LL) == 1, "fmt_size_i64(6) should be 1");
    ROMANO_ASSERT(fmt_size_i64(-42990LL) == 6, "fmt_size_i64(-42990) should be 6");
    ROMANO_ASSERT(fmt_size_i64(18370LL) == 5, "fmt_size_i64(18370) should be 5");
    ROMANO_ASSERT(fmt_size_i64(23216233559990LL) == 14, "fmt_size_i64(23216233559990) should be 14");
    ROMANO_ASSERT(fmt_size_i64(22116505LL) == 8, "fmt_size_i64(22116505) should be 8");
    ROMANO_ASSERT(fmt_size_i64(778507658LL) == 9, "fmt_size_i64(778507658) should be 9");
    ROMANO_ASSERT(fmt_size_i64(-9312007400LL) == 11, "fmt_size_i64(-9312007400) should be 11");
    ROMANO_ASSERT(fmt_size_i64(-1LL) == 2, "fmt_size_i64(-1) should be 2");
    ROMANO_ASSERT(fmt_size_i64(-27211983559576LL) == 15, "fmt_size_i64(-27211983559576) should be 15");
    ROMANO_ASSERT(fmt_size_i64(14690326052061045LL) == 17, "fmt_size_i64(14690326052061045) should be 17");
    ROMANO_ASSERT(fmt_size_i64(118825LL) == 6, "fmt_size_i64(118825) should be 6");
    ROMANO_ASSERT(fmt_size_i64(883955276LL) == 9, "fmt_size_i64(883955276) should be 9");
    ROMANO_ASSERT(fmt_size_i64(1193338220LL) == 10, "fmt_size_i64(1193338220) should be 10");
    ROMANO_ASSERT(fmt_size_i64(-36917LL) == 6, "fmt_size_i64(-36917) should be 6");
    ROMANO_ASSERT(fmt_size_i64(601941992421166988LL) == 18, "fmt_size_i64(601941992421166988) should be 18");
    ROMANO_ASSERT(fmt_size_i64(-88LL) == 3, "fmt_size_i64(-88) should be 3");
    ROMANO_ASSERT(fmt_size_i64(17341694312LL) == 11, "fmt_size_i64(17341694312) should be 11");
    ROMANO_ASSERT(fmt_size_i64(388134475215818609LL) == 18, "fmt_size_i64(388134475215818609) should be 18");
    ROMANO_ASSERT(fmt_size_i64(-459LL) == 4, "fmt_size_i64(-459) should be 4");
    ROMANO_ASSERT(fmt_size_i64(2483092851178829937LL) == 19, "fmt_size_i64(2483092851178829937) should be 19");
    ROMANO_ASSERT(fmt_size_i64(4499049210651090115LL) == 19, "fmt_size_i64(4499049210651090115) should be 19");
    ROMANO_ASSERT(fmt_size_i64(25864281431LL) == 11, "fmt_size_i64(25864281431) should be 11");
    ROMANO_ASSERT(fmt_size_i64(-43985509LL) == 9, "fmt_size_i64(-43985509) should be 9");
    ROMANO_ASSERT(fmt_size_i64(0LL) == 1, "fmt_size_i64(0) should be 1");
    ROMANO_ASSERT(fmt_size_i64(511949744LL) == 9, "fmt_size_i64(511949744) should be 9");
    ROMANO_ASSERT(fmt_size_i64(324194016421328320LL) == 18, "fmt_size_i64(324194016421328320) should be 18");
    ROMANO_ASSERT(fmt_size_i64(-585LL) == 4, "fmt_size_i64(-585) should be 4");
    ROMANO_ASSERT(fmt_size_i64(222296LL) == 6, "fmt_size_i64(222296) should be 6");
    ROMANO_ASSERT(fmt_size_i64(3229543216416303LL) == 16, "fmt_size_i64(3229543216416303) should be 16");
    ROMANO_ASSERT(fmt_size_i64(-38580LL) == 6, "fmt_size_i64(-38580) should be 6");
    ROMANO_ASSERT(fmt_size_i64(-1752351726918LL) == 14, "fmt_size_i64(-1752351726918) should be 14");

    char i64_buffer[32];
    int i64_fmt_sz;

    i64_fmt_sz = fmt_i64(i64_buffer, -173209382697181207LL);
    ROMANO_ASSERT(i64_fmt_sz == 19, "i64_fmt_sz should be 19");
    ROMANO_ASSERT(memcmp(i64_buffer, "-173209382697181207", i64_fmt_sz) == 0, "fmt_i64(-173209382697181207) should be -173209382697181207");
    i64_fmt_sz = fmt_i64(i64_buffer, -28835779087LL);
    ROMANO_ASSERT(i64_fmt_sz == 12, "i64_fmt_sz should be 12");
    ROMANO_ASSERT(memcmp(i64_buffer, "-28835779087", i64_fmt_sz) == 0, "fmt_i64(-28835779087) should be -28835779087");
    i64_fmt_sz = fmt_i64(i64_buffer, -1649LL);
    ROMANO_ASSERT(i64_fmt_sz == 5, "i64_fmt_sz should be 5");
    ROMANO_ASSERT(memcmp(i64_buffer, "-1649", i64_fmt_sz) == 0, "fmt_i64(-1649) should be -1649");
    i64_fmt_sz = fmt_i64(i64_buffer, 4376963590107078323LL);
    ROMANO_ASSERT(i64_fmt_sz == 19, "i64_fmt_sz should be 19");
    ROMANO_ASSERT(memcmp(i64_buffer, "4376963590107078323", i64_fmt_sz) == 0, "fmt_i64(4376963590107078323) should be 4376963590107078323");
    i64_fmt_sz = fmt_i64(i64_buffer, -3722633LL);
    ROMANO_ASSERT(i64_fmt_sz == 8, "i64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(i64_buffer, "-3722633", i64_fmt_sz) == 0, "fmt_i64(-3722633) should be -3722633");
    i64_fmt_sz = fmt_i64(i64_buffer, 30LL);
    ROMANO_ASSERT(i64_fmt_sz == 2, "i64_fmt_sz should be 2");
    ROMANO_ASSERT(memcmp(i64_buffer, "30", i64_fmt_sz) == 0, "fmt_i64(30) should be 30");
    i64_fmt_sz = fmt_i64(i64_buffer, 884325139088025LL);
    ROMANO_ASSERT(i64_fmt_sz == 15, "i64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(i64_buffer, "884325139088025", i64_fmt_sz) == 0, "fmt_i64(884325139088025) should be 884325139088025");
    i64_fmt_sz = fmt_i64(i64_buffer, 1066496790LL);
    ROMANO_ASSERT(i64_fmt_sz == 10, "i64_fmt_sz should be 10");
    ROMANO_ASSERT(memcmp(i64_buffer, "1066496790", i64_fmt_sz) == 0, "fmt_i64(1066496790) should be 1066496790");
    i64_fmt_sz = fmt_i64(i64_buffer, 1972617LL);
    ROMANO_ASSERT(i64_fmt_sz == 7, "i64_fmt_sz should be 7");
    ROMANO_ASSERT(memcmp(i64_buffer, "1972617", i64_fmt_sz) == 0, "fmt_i64(1972617) should be 1972617");
    i64_fmt_sz = fmt_i64(i64_buffer, 12LL);
    ROMANO_ASSERT(i64_fmt_sz == 2, "i64_fmt_sz should be 2");
    ROMANO_ASSERT(memcmp(i64_buffer, "12", i64_fmt_sz) == 0, "fmt_i64(12) should be 12");
    i64_fmt_sz = fmt_i64(i64_buffer, -2446564LL);
    ROMANO_ASSERT(i64_fmt_sz == 8, "i64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(i64_buffer, "-2446564", i64_fmt_sz) == 0, "fmt_i64(-2446564) should be -2446564");
    i64_fmt_sz = fmt_i64(i64_buffer, 235055LL);
    ROMANO_ASSERT(i64_fmt_sz == 6, "i64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(i64_buffer, "235055", i64_fmt_sz) == 0, "fmt_i64(235055) should be 235055");
    i64_fmt_sz = fmt_i64(i64_buffer, 1869904098086LL);
    ROMANO_ASSERT(i64_fmt_sz == 13, "i64_fmt_sz should be 13");
    ROMANO_ASSERT(memcmp(i64_buffer, "1869904098086", i64_fmt_sz) == 0, "fmt_i64(1869904098086) should be 1869904098086");
    i64_fmt_sz = fmt_i64(i64_buffer, 114989696827LL);
    ROMANO_ASSERT(i64_fmt_sz == 12, "i64_fmt_sz should be 12");
    ROMANO_ASSERT(memcmp(i64_buffer, "114989696827", i64_fmt_sz) == 0, "fmt_i64(114989696827) should be 114989696827");
    i64_fmt_sz = fmt_i64(i64_buffer, 6570858408196LL);
    ROMANO_ASSERT(i64_fmt_sz == 13, "i64_fmt_sz should be 13");
    ROMANO_ASSERT(memcmp(i64_buffer, "6570858408196", i64_fmt_sz) == 0, "fmt_i64(6570858408196) should be 6570858408196");
    i64_fmt_sz = fmt_i64(i64_buffer, -63LL);
    ROMANO_ASSERT(i64_fmt_sz == 3, "i64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(i64_buffer, "-63", i64_fmt_sz) == 0, "fmt_i64(-63) should be -63");
    i64_fmt_sz = fmt_i64(i64_buffer, -763221LL);
    ROMANO_ASSERT(i64_fmt_sz == 7, "i64_fmt_sz should be 7");
    ROMANO_ASSERT(memcmp(i64_buffer, "-763221", i64_fmt_sz) == 0, "fmt_i64(-763221) should be -763221");
    i64_fmt_sz = fmt_i64(i64_buffer, -1LL);
    ROMANO_ASSERT(i64_fmt_sz == 2, "i64_fmt_sz should be 2");
    ROMANO_ASSERT(memcmp(i64_buffer, "-1", i64_fmt_sz) == 0, "fmt_i64(-1) should be -1");
    i64_fmt_sz = fmt_i64(i64_buffer, -6991783363314LL);
    ROMANO_ASSERT(i64_fmt_sz == 14, "i64_fmt_sz should be 14");
    ROMANO_ASSERT(memcmp(i64_buffer, "-6991783363314", i64_fmt_sz) == 0, "fmt_i64(-6991783363314) should be -6991783363314");
    i64_fmt_sz = fmt_i64(i64_buffer, 34060666LL);
    ROMANO_ASSERT(i64_fmt_sz == 8, "i64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(i64_buffer, "34060666", i64_fmt_sz) == 0, "fmt_i64(34060666) should be 34060666");
    i64_fmt_sz = fmt_i64(i64_buffer, 127434378LL);
    ROMANO_ASSERT(i64_fmt_sz == 9, "i64_fmt_sz should be 9");
    ROMANO_ASSERT(memcmp(i64_buffer, "127434378", i64_fmt_sz) == 0, "fmt_i64(127434378) should be 127434378");
    i64_fmt_sz = fmt_i64(i64_buffer, 8055669361585378LL);
    ROMANO_ASSERT(i64_fmt_sz == 16, "i64_fmt_sz should be 16");
    ROMANO_ASSERT(memcmp(i64_buffer, "8055669361585378", i64_fmt_sz) == 0, "fmt_i64(8055669361585378) should be 8055669361585378");
    i64_fmt_sz = fmt_i64(i64_buffer, 396LL);
    ROMANO_ASSERT(i64_fmt_sz == 3, "i64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(i64_buffer, "396", i64_fmt_sz) == 0, "fmt_i64(396) should be 396");
    i64_fmt_sz = fmt_i64(i64_buffer, -7756264360967LL);
    ROMANO_ASSERT(i64_fmt_sz == 14, "i64_fmt_sz should be 14");
    ROMANO_ASSERT(memcmp(i64_buffer, "-7756264360967", i64_fmt_sz) == 0, "fmt_i64(-7756264360967) should be -7756264360967");
    i64_fmt_sz = fmt_i64(i64_buffer, -1463866883966067980LL);
    ROMANO_ASSERT(i64_fmt_sz == 20, "i64_fmt_sz should be 20");
    ROMANO_ASSERT(memcmp(i64_buffer, "-1463866883966067980", i64_fmt_sz) == 0, "fmt_i64(-1463866883966067980) should be -1463866883966067980");
    i64_fmt_sz = fmt_i64(i64_buffer, -310682459046LL);
    ROMANO_ASSERT(i64_fmt_sz == 13, "i64_fmt_sz should be 13");
    ROMANO_ASSERT(memcmp(i64_buffer, "-310682459046", i64_fmt_sz) == 0, "fmt_i64(-310682459046) should be -310682459046");
    i64_fmt_sz = fmt_i64(i64_buffer, -86223877978882372LL);
    ROMANO_ASSERT(i64_fmt_sz == 18, "i64_fmt_sz should be 18");
    ROMANO_ASSERT(memcmp(i64_buffer, "-86223877978882372", i64_fmt_sz) == 0, "fmt_i64(-86223877978882372) should be -86223877978882372");
    i64_fmt_sz = fmt_i64(i64_buffer, -11013925370010743LL);
    ROMANO_ASSERT(i64_fmt_sz == 18, "i64_fmt_sz should be 18");
    ROMANO_ASSERT(memcmp(i64_buffer, "-11013925370010743", i64_fmt_sz) == 0, "fmt_i64(-11013925370010743) should be -11013925370010743");
    i64_fmt_sz = fmt_i64(i64_buffer, 1LL);
    ROMANO_ASSERT(i64_fmt_sz == 1, "i64_fmt_sz should be 1");
    ROMANO_ASSERT(memcmp(i64_buffer, "1", i64_fmt_sz) == 0, "fmt_i64(1) should be 1");
    i64_fmt_sz = fmt_i64(i64_buffer, -27811461LL);
    ROMANO_ASSERT(i64_fmt_sz == 9, "i64_fmt_sz should be 9");
    ROMANO_ASSERT(memcmp(i64_buffer, "-27811461", i64_fmt_sz) == 0, "fmt_i64(-27811461) should be -27811461");
    i64_fmt_sz = fmt_i64(i64_buffer, -56558217676165LL);
    ROMANO_ASSERT(i64_fmt_sz == 15, "i64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(i64_buffer, "-56558217676165", i64_fmt_sz) == 0, "fmt_i64(-56558217676165) should be -56558217676165");
    i64_fmt_sz = fmt_i64(i64_buffer, 74LL);
    ROMANO_ASSERT(i64_fmt_sz == 2, "i64_fmt_sz should be 2");
    ROMANO_ASSERT(memcmp(i64_buffer, "74", i64_fmt_sz) == 0, "fmt_i64(74) should be 74");
    i64_fmt_sz = fmt_i64(i64_buffer, -79369LL);
    ROMANO_ASSERT(i64_fmt_sz == 6, "i64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(i64_buffer, "-79369", i64_fmt_sz) == 0, "fmt_i64(-79369) should be -79369");
    i64_fmt_sz = fmt_i64(i64_buffer, 1940436LL);
    ROMANO_ASSERT(i64_fmt_sz == 7, "i64_fmt_sz should be 7");
    ROMANO_ASSERT(memcmp(i64_buffer, "1940436", i64_fmt_sz) == 0, "fmt_i64(1940436) should be 1940436");
    i64_fmt_sz = fmt_i64(i64_buffer, -191LL);
    ROMANO_ASSERT(i64_fmt_sz == 4, "i64_fmt_sz should be 4");
    ROMANO_ASSERT(memcmp(i64_buffer, "-191", i64_fmt_sz) == 0, "fmt_i64(-191) should be -191");
    i64_fmt_sz = fmt_i64(i64_buffer, 408117LL);
    ROMANO_ASSERT(i64_fmt_sz == 6, "i64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(i64_buffer, "408117", i64_fmt_sz) == 0, "fmt_i64(408117) should be 408117");
    i64_fmt_sz = fmt_i64(i64_buffer, 1LL);
    ROMANO_ASSERT(i64_fmt_sz == 1, "i64_fmt_sz should be 1");
    ROMANO_ASSERT(memcmp(i64_buffer, "1", i64_fmt_sz) == 0, "fmt_i64(1) should be 1");
    i64_fmt_sz = fmt_i64(i64_buffer, 52196556492LL);
    ROMANO_ASSERT(i64_fmt_sz == 11, "i64_fmt_sz should be 11");
    ROMANO_ASSERT(memcmp(i64_buffer, "52196556492", i64_fmt_sz) == 0, "fmt_i64(52196556492) should be 52196556492");
    i64_fmt_sz = fmt_i64(i64_buffer, -106621LL);
    ROMANO_ASSERT(i64_fmt_sz == 7, "i64_fmt_sz should be 7");
    ROMANO_ASSERT(memcmp(i64_buffer, "-106621", i64_fmt_sz) == 0, "fmt_i64(-106621) should be -106621");
    i64_fmt_sz = fmt_i64(i64_buffer, -678515859288LL);
    ROMANO_ASSERT(i64_fmt_sz == 13, "i64_fmt_sz should be 13");
    ROMANO_ASSERT(memcmp(i64_buffer, "-678515859288", i64_fmt_sz) == 0, "fmt_i64(-678515859288) should be -678515859288");
    i64_fmt_sz = fmt_i64(i64_buffer, 4165336LL);
    ROMANO_ASSERT(i64_fmt_sz == 7, "i64_fmt_sz should be 7");
    ROMANO_ASSERT(memcmp(i64_buffer, "4165336", i64_fmt_sz) == 0, "fmt_i64(4165336) should be 4165336");
    i64_fmt_sz = fmt_i64(i64_buffer, 2002119849LL);
    ROMANO_ASSERT(i64_fmt_sz == 10, "i64_fmt_sz should be 10");
    ROMANO_ASSERT(memcmp(i64_buffer, "2002119849", i64_fmt_sz) == 0, "fmt_i64(2002119849) should be 2002119849");
    i64_fmt_sz = fmt_i64(i64_buffer, -1647751078LL);
    ROMANO_ASSERT(i64_fmt_sz == 11, "i64_fmt_sz should be 11");
    ROMANO_ASSERT(memcmp(i64_buffer, "-1647751078", i64_fmt_sz) == 0, "fmt_i64(-1647751078) should be -1647751078");
    i64_fmt_sz = fmt_i64(i64_buffer, 7813344575LL);
    ROMANO_ASSERT(i64_fmt_sz == 10, "i64_fmt_sz should be 10");
    ROMANO_ASSERT(memcmp(i64_buffer, "7813344575", i64_fmt_sz) == 0, "fmt_i64(7813344575) should be 7813344575");
    i64_fmt_sz = fmt_i64(i64_buffer, 140796LL);
    ROMANO_ASSERT(i64_fmt_sz == 6, "i64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(i64_buffer, "140796", i64_fmt_sz) == 0, "fmt_i64(140796) should be 140796");
    i64_fmt_sz = fmt_i64(i64_buffer, 5888221834LL);
    ROMANO_ASSERT(i64_fmt_sz == 10, "i64_fmt_sz should be 10");
    ROMANO_ASSERT(memcmp(i64_buffer, "5888221834", i64_fmt_sz) == 0, "fmt_i64(5888221834) should be 5888221834");
    i64_fmt_sz = fmt_i64(i64_buffer, -7LL);
    ROMANO_ASSERT(i64_fmt_sz == 2, "i64_fmt_sz should be 2");
    ROMANO_ASSERT(memcmp(i64_buffer, "-7", i64_fmt_sz) == 0, "fmt_i64(-7) should be -7");
    i64_fmt_sz = fmt_i64(i64_buffer, 6198LL);
    ROMANO_ASSERT(i64_fmt_sz == 4, "i64_fmt_sz should be 4");
    ROMANO_ASSERT(memcmp(i64_buffer, "6198", i64_fmt_sz) == 0, "fmt_i64(6198) should be 6198");
    i64_fmt_sz = fmt_i64(i64_buffer, -1754137951175LL);
    ROMANO_ASSERT(i64_fmt_sz == 14, "i64_fmt_sz should be 14");
    ROMANO_ASSERT(memcmp(i64_buffer, "-1754137951175", i64_fmt_sz) == 0, "fmt_i64(-1754137951175) should be -1754137951175");
    i64_fmt_sz = fmt_i64(i64_buffer, -4605LL);
    ROMANO_ASSERT(i64_fmt_sz == 5, "i64_fmt_sz should be 5");
    ROMANO_ASSERT(memcmp(i64_buffer, "-4605", i64_fmt_sz) == 0, "fmt_i64(-4605) should be -4605");

    ROMANO_ASSERT(fmt_size_u64(0) == 1, "");
    ROMANO_ASSERT(fmt_size_u64(41ULL) == 2, "fmt_size_u64(41) should be 2");
    ROMANO_ASSERT(fmt_size_u64(222ULL) == 3, "fmt_size_u64(222) should be 3");
    ROMANO_ASSERT(fmt_size_u64(45247262217ULL) == 11, "fmt_size_u64(45247262217) should be 11");
    ROMANO_ASSERT(fmt_size_u64(51581ULL) == 5, "fmt_size_u64(51581) should be 5");
    ROMANO_ASSERT(fmt_size_u64(127ULL) == 3, "fmt_size_u64(127) should be 3");
    ROMANO_ASSERT(fmt_size_u64(72289733ULL) == 8, "fmt_size_u64(72289733) should be 8");
    ROMANO_ASSERT(fmt_size_u64(104488675676533ULL) == 15, "fmt_size_u64(104488675676533) should be 15");
    ROMANO_ASSERT(fmt_size_u64(66425569783733837ULL) == 17, "fmt_size_u64(66425569783733837) should be 17");
    ROMANO_ASSERT(fmt_size_u64(862ULL) == 3, "fmt_size_u64(862) should be 3");
    ROMANO_ASSERT(fmt_size_u64(44898ULL) == 5, "fmt_size_u64(44898) should be 5");
    ROMANO_ASSERT(fmt_size_u64(2153971187484ULL) == 13, "fmt_size_u64(2153971187484) should be 13");
    ROMANO_ASSERT(fmt_size_u64(488ULL) == 3, "fmt_size_u64(488) should be 3");
    ROMANO_ASSERT(fmt_size_u64(31ULL) == 2, "fmt_size_u64(31) should be 2");
    ROMANO_ASSERT(fmt_size_u64(832869641511486562ULL) == 18, "fmt_size_u64(832869641511486562) should be 18");
    ROMANO_ASSERT(fmt_size_u64(7ULL) == 1, "fmt_size_u64(7) should be 1");
    ROMANO_ASSERT(fmt_size_u64(18ULL) == 2, "fmt_size_u64(18) should be 2");
    ROMANO_ASSERT(fmt_size_u64(628ULL) == 3, "fmt_size_u64(628) should be 3");
    ROMANO_ASSERT(fmt_size_u64(411978232ULL) == 9, "fmt_size_u64(411978232) should be 9");
    ROMANO_ASSERT(fmt_size_u64(488508201ULL) == 9, "fmt_size_u64(488508201) should be 9");
    ROMANO_ASSERT(fmt_size_u64(1257348572568301ULL) == 16, "fmt_size_u64(1257348572568301) should be 16");
    ROMANO_ASSERT(fmt_size_u64(63734561051074ULL) == 14, "fmt_size_u64(63734561051074) should be 14");
    ROMANO_ASSERT(fmt_size_u64(224619ULL) == 6, "fmt_size_u64(224619) should be 6");
    ROMANO_ASSERT(fmt_size_u64(6910679ULL) == 7, "fmt_size_u64(6910679) should be 7");
    ROMANO_ASSERT(fmt_size_u64(1274148ULL) == 7, "fmt_size_u64(1274148) should be 7");
    ROMANO_ASSERT(fmt_size_u64(21ULL) == 2, "fmt_size_u64(21) should be 2");
    ROMANO_ASSERT(fmt_size_u64(653ULL) == 3, "fmt_size_u64(653) should be 3");
    ROMANO_ASSERT(fmt_size_u64(44192ULL) == 5, "fmt_size_u64(44192) should be 5");
    ROMANO_ASSERT(fmt_size_u64(362403486038552ULL) == 15, "fmt_size_u64(362403486038552) should be 15");
    ROMANO_ASSERT(fmt_size_u64(15639203117862682ULL) == 17, "fmt_size_u64(15639203117862682) should be 17");
    ROMANO_ASSERT(fmt_size_u64(509042ULL) == 6, "fmt_size_u64(509042) should be 6");
    ROMANO_ASSERT(fmt_size_u64(10944064370272777ULL) == 17, "fmt_size_u64(10944064370272777) should be 17");
    ROMANO_ASSERT(fmt_size_u64(1472ULL) == 4, "fmt_size_u64(1472) should be 4");
    ROMANO_ASSERT(fmt_size_u64(6274ULL) == 4, "fmt_size_u64(6274) should be 4");
    ROMANO_ASSERT(fmt_size_u64(16ULL) == 2, "fmt_size_u64(16) should be 2");
    ROMANO_ASSERT(fmt_size_u64(46432856ULL) == 8, "fmt_size_u64(46432856) should be 8");
    ROMANO_ASSERT(fmt_size_u64(2684711642920472ULL) == 16, "fmt_size_u64(2684711642920472) should be 16");
    ROMANO_ASSERT(fmt_size_u64(521010780221ULL) == 12, "fmt_size_u64(521010780221) should be 12");
    ROMANO_ASSERT(fmt_size_u64(355739ULL) == 6, "fmt_size_u64(355739) should be 6");
    ROMANO_ASSERT(fmt_size_u64(109173361315453ULL) == 15, "fmt_size_u64(109173361315453) should be 15");
    ROMANO_ASSERT(fmt_size_u64(2137832058ULL) == 10, "fmt_size_u64(2137832058) should be 10");
    ROMANO_ASSERT(fmt_size_u64(10953ULL) == 5, "fmt_size_u64(10953) should be 5");
    ROMANO_ASSERT(fmt_size_u64(3308204297276139ULL) == 16, "fmt_size_u64(3308204297276139) should be 16");
    ROMANO_ASSERT(fmt_size_u64(173422ULL) == 6, "fmt_size_u64(173422) should be 6");
    ROMANO_ASSERT(fmt_size_u64(24823120060918183ULL) == 17, "fmt_size_u64(24823120060918183) should be 17");
    ROMANO_ASSERT(fmt_size_u64(14445883064131660ULL) == 17, "fmt_size_u64(14445883064131660) should be 17");
    ROMANO_ASSERT(fmt_size_u64(75512527ULL) == 8, "fmt_size_u64(75512527) should be 8");
    ROMANO_ASSERT(fmt_size_u64(2064ULL) == 4, "fmt_size_u64(2064) should be 4");
    ROMANO_ASSERT(fmt_size_u64(8137097354ULL) == 10, "fmt_size_u64(8137097354) should be 10");
    ROMANO_ASSERT(fmt_size_u64(44ULL) == 2, "fmt_size_u64(44) should be 2");
    ROMANO_ASSERT(fmt_size_u64(44044ULL) == 5, "fmt_size_u64(44044) should be 5");

    char u64_buffer[32];
    int u64_fmt_sz;

    u64_fmt_sz = fmt_u64(u64_buffer, 255235274931984ULL);
    ROMANO_ASSERT(u64_fmt_sz == 15, "u64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(u64_buffer, "255235274931984", u64_fmt_sz) == 0, "fmt_u64(255235274931984) should be 255235274931984");
    u64_fmt_sz = fmt_u64(u64_buffer, 202ULL);
    ROMANO_ASSERT(u64_fmt_sz == 3, "u64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(u64_buffer, "202", u64_fmt_sz) == 0, "fmt_u64(202) should be 202");
    u64_fmt_sz = fmt_u64(u64_buffer, 109122ULL);
    ROMANO_ASSERT(u64_fmt_sz == 6, "u64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(u64_buffer, "109122", u64_fmt_sz) == 0, "fmt_u64(109122) should be 109122");
    u64_fmt_sz = fmt_u64(u64_buffer, 500266410889687ULL);
    ROMANO_ASSERT(u64_fmt_sz == 15, "u64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(u64_buffer, "500266410889687", u64_fmt_sz) == 0, "fmt_u64(500266410889687) should be 500266410889687");
    u64_fmt_sz = fmt_u64(u64_buffer, 1519266584ULL);
    ROMANO_ASSERT(u64_fmt_sz == 10, "u64_fmt_sz should be 10");
    ROMANO_ASSERT(memcmp(u64_buffer, "1519266584", u64_fmt_sz) == 0, "fmt_u64(1519266584) should be 1519266584");
    u64_fmt_sz = fmt_u64(u64_buffer, 11174434ULL);
    ROMANO_ASSERT(u64_fmt_sz == 8, "u64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(u64_buffer, "11174434", u64_fmt_sz) == 0, "fmt_u64(11174434) should be 11174434");
    u64_fmt_sz = fmt_u64(u64_buffer, 137ULL);
    ROMANO_ASSERT(u64_fmt_sz == 3, "u64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(u64_buffer, "137", u64_fmt_sz) == 0, "fmt_u64(137) should be 137");
    u64_fmt_sz = fmt_u64(u64_buffer, 13585625104308ULL);
    ROMANO_ASSERT(u64_fmt_sz == 14, "u64_fmt_sz should be 14");
    ROMANO_ASSERT(memcmp(u64_buffer, "13585625104308", u64_fmt_sz) == 0, "fmt_u64(13585625104308) should be 13585625104308");
    u64_fmt_sz = fmt_u64(u64_buffer, 15381ULL);
    ROMANO_ASSERT(u64_fmt_sz == 5, "u64_fmt_sz should be 5");
    ROMANO_ASSERT(memcmp(u64_buffer, "15381", u64_fmt_sz) == 0, "fmt_u64(15381) should be 15381");
    u64_fmt_sz = fmt_u64(u64_buffer, 19943919042ULL);
    ROMANO_ASSERT(u64_fmt_sz == 11, "u64_fmt_sz should be 11");
    ROMANO_ASSERT(memcmp(u64_buffer, "19943919042", u64_fmt_sz) == 0, "fmt_u64(19943919042) should be 19943919042");
    u64_fmt_sz = fmt_u64(u64_buffer, 203638686ULL);
    ROMANO_ASSERT(u64_fmt_sz == 9, "u64_fmt_sz should be 9");
    ROMANO_ASSERT(memcmp(u64_buffer, "203638686", u64_fmt_sz) == 0, "fmt_u64(203638686) should be 203638686");
    u64_fmt_sz = fmt_u64(u64_buffer, 266822ULL);
    ROMANO_ASSERT(u64_fmt_sz == 6, "u64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(u64_buffer, "266822", u64_fmt_sz) == 0, "fmt_u64(266822) should be 266822");
    u64_fmt_sz = fmt_u64(u64_buffer, 374841603951887ULL);
    ROMANO_ASSERT(u64_fmt_sz == 15, "u64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(u64_buffer, "374841603951887", u64_fmt_sz) == 0, "fmt_u64(374841603951887) should be 374841603951887");
    u64_fmt_sz = fmt_u64(u64_buffer, 26ULL);
    ROMANO_ASSERT(u64_fmt_sz == 2, "u64_fmt_sz should be 2");
    ROMANO_ASSERT(memcmp(u64_buffer, "26", u64_fmt_sz) == 0, "fmt_u64(26) should be 26");
    u64_fmt_sz = fmt_u64(u64_buffer, 767336766487534384ULL);
    ROMANO_ASSERT(u64_fmt_sz == 18, "u64_fmt_sz should be 18");
    ROMANO_ASSERT(memcmp(u64_buffer, "767336766487534384", u64_fmt_sz) == 0, "fmt_u64(767336766487534384) should be 767336766487534384");
    u64_fmt_sz = fmt_u64(u64_buffer, 6569601413ULL);
    ROMANO_ASSERT(u64_fmt_sz == 10, "u64_fmt_sz should be 10");
    ROMANO_ASSERT(memcmp(u64_buffer, "6569601413", u64_fmt_sz) == 0, "fmt_u64(6569601413) should be 6569601413");
    u64_fmt_sz = fmt_u64(u64_buffer, 358ULL);
    ROMANO_ASSERT(u64_fmt_sz == 3, "u64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(u64_buffer, "358", u64_fmt_sz) == 0, "fmt_u64(358) should be 358");
    u64_fmt_sz = fmt_u64(u64_buffer, 111613617325769ULL);
    ROMANO_ASSERT(u64_fmt_sz == 15, "u64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(u64_buffer, "111613617325769", u64_fmt_sz) == 0, "fmt_u64(111613617325769) should be 111613617325769");
    u64_fmt_sz = fmt_u64(u64_buffer, 185764142392ULL);
    ROMANO_ASSERT(u64_fmt_sz == 12, "u64_fmt_sz should be 12");
    ROMANO_ASSERT(memcmp(u64_buffer, "185764142392", u64_fmt_sz) == 0, "fmt_u64(185764142392) should be 185764142392");
    u64_fmt_sz = fmt_u64(u64_buffer, 341899175251622608ULL);
    ROMANO_ASSERT(u64_fmt_sz == 18, "u64_fmt_sz should be 18");
    ROMANO_ASSERT(memcmp(u64_buffer, "341899175251622608", u64_fmt_sz) == 0, "fmt_u64(341899175251622608) should be 341899175251622608");
    u64_fmt_sz = fmt_u64(u64_buffer, 92635ULL);
    ROMANO_ASSERT(u64_fmt_sz == 5, "u64_fmt_sz should be 5");
    ROMANO_ASSERT(memcmp(u64_buffer, "92635", u64_fmt_sz) == 0, "fmt_u64(92635) should be 92635");
    u64_fmt_sz = fmt_u64(u64_buffer, 31249639918795ULL);
    ROMANO_ASSERT(u64_fmt_sz == 14, "u64_fmt_sz should be 14");
    ROMANO_ASSERT(memcmp(u64_buffer, "31249639918795", u64_fmt_sz) == 0, "fmt_u64(31249639918795) should be 31249639918795");
    u64_fmt_sz = fmt_u64(u64_buffer, 9472492955818898ULL);
    ROMANO_ASSERT(u64_fmt_sz == 16, "u64_fmt_sz should be 16");
    ROMANO_ASSERT(memcmp(u64_buffer, "9472492955818898", u64_fmt_sz) == 0, "fmt_u64(9472492955818898) should be 9472492955818898");
    u64_fmt_sz = fmt_u64(u64_buffer, 12487239ULL);
    ROMANO_ASSERT(u64_fmt_sz == 8, "u64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(u64_buffer, "12487239", u64_fmt_sz) == 0, "fmt_u64(12487239) should be 12487239");
    u64_fmt_sz = fmt_u64(u64_buffer, 9679551926933ULL);
    ROMANO_ASSERT(u64_fmt_sz == 13, "u64_fmt_sz should be 13");
    ROMANO_ASSERT(memcmp(u64_buffer, "9679551926933", u64_fmt_sz) == 0, "fmt_u64(9679551926933) should be 9679551926933");
    u64_fmt_sz = fmt_u64(u64_buffer, 1070290635ULL);
    ROMANO_ASSERT(u64_fmt_sz == 10, "u64_fmt_sz should be 10");
    ROMANO_ASSERT(memcmp(u64_buffer, "1070290635", u64_fmt_sz) == 0, "fmt_u64(1070290635) should be 1070290635");
    u64_fmt_sz = fmt_u64(u64_buffer, 123ULL);
    ROMANO_ASSERT(u64_fmt_sz == 3, "u64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(u64_buffer, "123", u64_fmt_sz) == 0, "fmt_u64(123) should be 123");
    u64_fmt_sz = fmt_u64(u64_buffer, 7724286222ULL);
    ROMANO_ASSERT(u64_fmt_sz == 10, "u64_fmt_sz should be 10");
    ROMANO_ASSERT(memcmp(u64_buffer, "7724286222", u64_fmt_sz) == 0, "fmt_u64(7724286222) should be 7724286222");
    u64_fmt_sz = fmt_u64(u64_buffer, 52172658ULL);
    ROMANO_ASSERT(u64_fmt_sz == 8, "u64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(u64_buffer, "52172658", u64_fmt_sz) == 0, "fmt_u64(52172658) should be 52172658");
    u64_fmt_sz = fmt_u64(u64_buffer, 20ULL);
    ROMANO_ASSERT(u64_fmt_sz == 2, "u64_fmt_sz should be 2");
    ROMANO_ASSERT(memcmp(u64_buffer, "20", u64_fmt_sz) == 0, "fmt_u64(20) should be 20");
    u64_fmt_sz = fmt_u64(u64_buffer, 499ULL);
    ROMANO_ASSERT(u64_fmt_sz == 3, "u64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(u64_buffer, "499", u64_fmt_sz) == 0, "fmt_u64(499) should be 499");
    u64_fmt_sz = fmt_u64(u64_buffer, 2ULL);
    ROMANO_ASSERT(u64_fmt_sz == 1, "u64_fmt_sz should be 1");
    ROMANO_ASSERT(memcmp(u64_buffer, "2", u64_fmt_sz) == 0, "fmt_u64(2) should be 2");
    u64_fmt_sz = fmt_u64(u64_buffer, 842733610840705ULL);
    ROMANO_ASSERT(u64_fmt_sz == 15, "u64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(u64_buffer, "842733610840705", u64_fmt_sz) == 0, "fmt_u64(842733610840705) should be 842733610840705");
    u64_fmt_sz = fmt_u64(u64_buffer, 129009710030912ULL);
    ROMANO_ASSERT(u64_fmt_sz == 15, "u64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(u64_buffer, "129009710030912", u64_fmt_sz) == 0, "fmt_u64(129009710030912) should be 129009710030912");
    u64_fmt_sz = fmt_u64(u64_buffer, 40436471250659506ULL);
    ROMANO_ASSERT(u64_fmt_sz == 17, "u64_fmt_sz should be 17");
    ROMANO_ASSERT(memcmp(u64_buffer, "40436471250659506", u64_fmt_sz) == 0, "fmt_u64(40436471250659506) should be 40436471250659506");
    u64_fmt_sz = fmt_u64(u64_buffer, 1225560ULL);
    ROMANO_ASSERT(u64_fmt_sz == 7, "u64_fmt_sz should be 7");
    ROMANO_ASSERT(memcmp(u64_buffer, "1225560", u64_fmt_sz) == 0, "fmt_u64(1225560) should be 1225560");
    u64_fmt_sz = fmt_u64(u64_buffer, 56690739471ULL);
    ROMANO_ASSERT(u64_fmt_sz == 11, "u64_fmt_sz should be 11");
    ROMANO_ASSERT(memcmp(u64_buffer, "56690739471", u64_fmt_sz) == 0, "fmt_u64(56690739471) should be 56690739471");
    u64_fmt_sz = fmt_u64(u64_buffer, 153245620708691ULL);
    ROMANO_ASSERT(u64_fmt_sz == 15, "u64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(u64_buffer, "153245620708691", u64_fmt_sz) == 0, "fmt_u64(153245620708691) should be 153245620708691");
    u64_fmt_sz = fmt_u64(u64_buffer, 1085643990973569ULL);
    ROMANO_ASSERT(u64_fmt_sz == 16, "u64_fmt_sz should be 16");
    ROMANO_ASSERT(memcmp(u64_buffer, "1085643990973569", u64_fmt_sz) == 0, "fmt_u64(1085643990973569) should be 1085643990973569");
    u64_fmt_sz = fmt_u64(u64_buffer, 3228ULL);
    ROMANO_ASSERT(u64_fmt_sz == 4, "u64_fmt_sz should be 4");
    ROMANO_ASSERT(memcmp(u64_buffer, "3228", u64_fmt_sz) == 0, "fmt_u64(3228) should be 3228");
    u64_fmt_sz = fmt_u64(u64_buffer, 28ULL);
    ROMANO_ASSERT(u64_fmt_sz == 2, "u64_fmt_sz should be 2");
    ROMANO_ASSERT(memcmp(u64_buffer, "28", u64_fmt_sz) == 0, "fmt_u64(28) should be 28");
    u64_fmt_sz = fmt_u64(u64_buffer, 1918ULL);
    ROMANO_ASSERT(u64_fmt_sz == 4, "u64_fmt_sz should be 4");
    ROMANO_ASSERT(memcmp(u64_buffer, "1918", u64_fmt_sz) == 0, "fmt_u64(1918) should be 1918");
    u64_fmt_sz = fmt_u64(u64_buffer, 427ULL);
    ROMANO_ASSERT(u64_fmt_sz == 3, "u64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(u64_buffer, "427", u64_fmt_sz) == 0, "fmt_u64(427) should be 427");
    u64_fmt_sz = fmt_u64(u64_buffer, 14620962ULL);
    ROMANO_ASSERT(u64_fmt_sz == 8, "u64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(u64_buffer, "14620962", u64_fmt_sz) == 0, "fmt_u64(14620962) should be 14620962");
    u64_fmt_sz = fmt_u64(u64_buffer, 94ULL);
    ROMANO_ASSERT(u64_fmt_sz == 2, "u64_fmt_sz should be 2");
    ROMANO_ASSERT(memcmp(u64_buffer, "94", u64_fmt_sz) == 0, "fmt_u64(94) should be 94");
    u64_fmt_sz = fmt_u64(u64_buffer, 2516ULL);
    ROMANO_ASSERT(u64_fmt_sz == 4, "u64_fmt_sz should be 4");
    ROMANO_ASSERT(memcmp(u64_buffer, "2516", u64_fmt_sz) == 0, "fmt_u64(2516) should be 2516");
    u64_fmt_sz = fmt_u64(u64_buffer, 10113252865490ULL);
    ROMANO_ASSERT(u64_fmt_sz == 14, "u64_fmt_sz should be 14");
    ROMANO_ASSERT(memcmp(u64_buffer, "10113252865490", u64_fmt_sz) == 0, "fmt_u64(10113252865490) should be 10113252865490");
    u64_fmt_sz = fmt_u64(u64_buffer, 70266123134255357ULL);
    ROMANO_ASSERT(u64_fmt_sz == 17, "u64_fmt_sz should be 17");
    ROMANO_ASSERT(memcmp(u64_buffer, "70266123134255357", u64_fmt_sz) == 0, "fmt_u64(70266123134255357) should be 70266123134255357");
    u64_fmt_sz = fmt_u64(u64_buffer, 888859447ULL);
    ROMANO_ASSERT(u64_fmt_sz == 9, "u64_fmt_sz should be 9");
    ROMANO_ASSERT(memcmp(u64_buffer, "888859447", u64_fmt_sz) == 0, "fmt_u64(888859447) should be 888859447");
    u64_fmt_sz = fmt_u64(u64_buffer, 14321810211134208ULL);
    ROMANO_ASSERT(u64_fmt_sz == 17, "u64_fmt_sz should be 17");
    ROMANO_ASSERT(memcmp(u64_buffer, "14321810211134208", u64_fmt_sz) == 0, "fmt_u64(14321810211134208) should be 14321810211134208");

    ROMANO_ASSERT(fmt_size_f64(0.0, 1) == 3, "fmt_size_f64(0.0, 1) should be 3");
    ROMANO_ASSERT(fmt_size_f64(0.0, 2) == 4, "fmt_size_f64(0.0, 2) should be 4");
    ROMANO_ASSERT(fmt_size_f64(0.0, 3) == 5, "fmt_size_f64(0.0, 3) should be 5");
    ROMANO_ASSERT(fmt_size_f64(0.0, 4) == 6, "fmt_size_f64(0.0, 4) should be 6");
    ROMANO_ASSERT(fmt_size_f64(0.0, 5) == 7, "fmt_size_f64(0.0, 5) should be 7");
    ROMANO_ASSERT(fmt_size_f64(0.0, 6) == 8, "fmt_size_f64(0.0, 6) should be 8");
    ROMANO_ASSERT(fmt_size_f64(0.0, 7) == 9, "fmt_size_f64(0.0, 7) should be 9");
    ROMANO_ASSERT(fmt_size_f64(0.0, 8) == 10, "fmt_size_f64(0.0, 8) should be 10");
    ROMANO_ASSERT(fmt_size_f64(0.0, 9) == 11, "fmt_size_f64(0.0, 9) should be 11");
    ROMANO_ASSERT(fmt_size_f64(0.0, 10) == 12, "fmt_size_f64(0.0, 10) should be 12");
    ROMANO_ASSERT(fmt_size_f64(0.0, 11) == 13, "fmt_size_f64(0.0, 11) should be 13");
    ROMANO_ASSERT(fmt_size_f64(0.0, 12) == 14, "fmt_size_f64(0.0, 12) should be 14");
    ROMANO_ASSERT(fmt_size_f64(0.0, 13) == 15, "fmt_size_f64(0.0, 13) should be 15");
    ROMANO_ASSERT(fmt_size_f64(0.0, 14) == 16, "fmt_size_f64(0.0, 14) should be 16");
    ROMANO_ASSERT(fmt_size_f64(0.0, 15) == 17, "fmt_size_f64(0.0, 15) should be 17");
    ROMANO_ASSERT(fmt_size_f64(0.0, 16) == 18, "fmt_size_f64(0.0, 16) should be 18");
    ROMANO_ASSERT(fmt_size_f64(0.0, 17) == 19, "fmt_size_f64(0.0, 17) should be 19");

    char f64_buffer[312];
    int f64_fmt_sz;

    f64_fmt_sz = fmt_f64(f64_buffer, 0.069977140, 9);
    ROMANO_ASSERT(f64_fmt_sz == 11, "f64_fmt_sz should be 11");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.069977140", f64_fmt_sz) == 0, "fmt_f64(0.06997713974400321) should be 0.06997713974400321");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.9051427785925, 13);
    ROMANO_ASSERT(f64_fmt_sz == 15, "f64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.9051427785925", f64_fmt_sz) == 0, "fmt_f64(0.9051427785924608) should be 0.9051427785924608");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.3170987523628, 13);
    ROMANO_ASSERT(f64_fmt_sz == 15, "f64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.3170987523628", f64_fmt_sz) == 0, "fmt_f64(0.31709875236279583) should be 0.31709875236279583");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.71401238345, 11);
    ROMANO_ASSERT(f64_fmt_sz == 13, "f64_fmt_sz should be 13");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.71401238345", f64_fmt_sz) == 0, "fmt_f64(0.7140123834453971) should be 0.7140123834453971");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.60798, 5);
    ROMANO_ASSERT(f64_fmt_sz == 7, "f64_fmt_sz should be 7");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.60798", f64_fmt_sz) == 0, "fmt_f64(0.6079824198950412) should be 0.6079824198950412");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.2, 1);
    ROMANO_ASSERT(f64_fmt_sz == 3, "f64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.2", f64_fmt_sz) == 0, "fmt_f64(0.20883790194601848) should be 0.20883790194601848");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.8931982651336874, 16);
    ROMANO_ASSERT(f64_fmt_sz == 18, "f64_fmt_sz should be 18");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.8931982651336874", f64_fmt_sz) == 0, "fmt_f64(0.8931982651336874) should be 0.8931982651336874");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.5476139, 7);
    ROMANO_ASSERT(f64_fmt_sz == 9, "f64_fmt_sz should be 9");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.5476139", f64_fmt_sz) == 0, "fmt_f64(0.5476139429029431) should be 0.5476139429029431");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.0807001960908, 13);
    ROMANO_ASSERT(f64_fmt_sz == 15, "f64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.0807001960908", f64_fmt_sz) == 0, "fmt_f64(0.08070019609084733) should be 0.08070019609084733");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.098815673, 9);
    ROMANO_ASSERT(f64_fmt_sz == 11, "f64_fmt_sz should be 11");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.098815673", f64_fmt_sz) == 0, "fmt_f64(0.09881567346979148) should be 0.09881567346979148");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.508537, 6);
    ROMANO_ASSERT(f64_fmt_sz == 8, "f64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.508537", f64_fmt_sz) == 0, "fmt_f64(0.5085367085793526) should be 0.5085367085793526");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.7, 1);
    ROMANO_ASSERT(f64_fmt_sz == 3, "f64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.7", f64_fmt_sz) == 0, "fmt_f64(0.7179535682636121) should be 0.7179535682636121");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.357, 3);
    ROMANO_ASSERT(f64_fmt_sz == 5, "f64_fmt_sz should be 5");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.357", f64_fmt_sz) == 0, "fmt_f64(0.35743548900021904) should be 0.35743548900021904");
    f64_fmt_sz = fmt_f64(f64_buffer, 1.0, 1);
    ROMANO_ASSERT(f64_fmt_sz == 3, "f64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(f64_buffer, "1.0", f64_fmt_sz) == 0, "fmt_f64(0.9803207115916178) should be 0.9803207115916178");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.1570990390, 10);
    ROMANO_ASSERT(f64_fmt_sz == 12, "f64_fmt_sz should be 12");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.1570990390", f64_fmt_sz) == 0, "fmt_f64(0.15709903897865607) should be 0.15709903897865607");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.208633, 6);
    ROMANO_ASSERT(f64_fmt_sz == 8, "f64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.208633", f64_fmt_sz) == 0, "fmt_f64(0.20863331108985095) should be 0.20863331108985095");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.5004269102, 10);
    ROMANO_ASSERT(f64_fmt_sz == 12, "f64_fmt_sz should be 12");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.5004269102", f64_fmt_sz) == 0, "fmt_f64(0.500426910198614) should be 0.500426910198614");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.0083, 4);
    ROMANO_ASSERT(f64_fmt_sz == 6, "f64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.0083", f64_fmt_sz) == 0, "fmt_f64(0.008307516110960589) should be 0.008307516110960589");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.906564, 6);
    ROMANO_ASSERT(f64_fmt_sz == 8, "f64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.906564", f64_fmt_sz) == 0, "fmt_f64(0.9065644322083463) should be 0.9065644322083463");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.67152, 5);
    ROMANO_ASSERT(f64_fmt_sz == 7, "f64_fmt_sz should be 7");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.67152", f64_fmt_sz) == 0, "fmt_f64(0.6715171190588587) should be 0.6715171190588587");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.9040834776692, 13);
    ROMANO_ASSERT(f64_fmt_sz == 15, "f64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.9040834776692", f64_fmt_sz) == 0, "fmt_f64(0.9040834776692226) should be 0.9040834776692226");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.6235964003087122, 16);
    ROMANO_ASSERT(f64_fmt_sz == 18, "f64_fmt_sz should be 18");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.6235964003087122", f64_fmt_sz) == 0, "fmt_f64(0.6235964003087122) should be 0.6235964003087122");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.6926, 4);
    ROMANO_ASSERT(f64_fmt_sz == 6, "f64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.6926", f64_fmt_sz) == 0, "fmt_f64(0.6926155441915283) should be 0.6926155441915283");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.259238864, 9);
    ROMANO_ASSERT(f64_fmt_sz == 11, "f64_fmt_sz should be 11");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.259238864", f64_fmt_sz) == 0, "fmt_f64(0.25923886388446515) should be 0.25923886388446515");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.2065461753510, 13);
    ROMANO_ASSERT(f64_fmt_sz == 15, "f64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.2065461753510", f64_fmt_sz) == 0, "fmt_f64(0.20654617535096642) should be 0.20654617535096642");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.315400176987662, 15);
    ROMANO_ASSERT(f64_fmt_sz == 17, "f64_fmt_sz should be 17");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.315400176987662", f64_fmt_sz) == 0, "fmt_f64(0.3154001769876621) should be 0.3154001769876621");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.43726030344074, 14);
    ROMANO_ASSERT(f64_fmt_sz == 16, "f64_fmt_sz should be 16");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.43726030344074", f64_fmt_sz) == 0, "fmt_f64(0.4372603034407432) should be 0.4372603034407432");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.874, 3);
    ROMANO_ASSERT(f64_fmt_sz == 5, "f64_fmt_sz should be 5");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.874", f64_fmt_sz) == 0, "fmt_f64(0.8737316380172113) should be 0.8737316380172113");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.798, 3);
    ROMANO_ASSERT(f64_fmt_sz == 5, "f64_fmt_sz should be 5");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.798", f64_fmt_sz) == 0, "fmt_f64(0.7975052147031356) should be 0.7975052147031356");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.5253, 4);
    ROMANO_ASSERT(f64_fmt_sz == 6, "f64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.5253", f64_fmt_sz) == 0, "fmt_f64(0.5252994393568572) should be 0.5252994393568572");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.69688, 5);
    ROMANO_ASSERT(f64_fmt_sz == 7, "f64_fmt_sz should be 7");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.69688", f64_fmt_sz) == 0, "fmt_f64(0.6968772564271036) should be 0.6968772564271036");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.49181175724, 11);
    ROMANO_ASSERT(f64_fmt_sz == 13, "f64_fmt_sz should be 13");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.49181175724", f64_fmt_sz) == 0, "fmt_f64(0.49181175724150705) should be 0.49181175724150705");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.684403955534, 12);
    ROMANO_ASSERT(f64_fmt_sz == 14, "f64_fmt_sz should be 14");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.684403955534", f64_fmt_sz) == 0, "fmt_f64(0.6844039555340735) should be 0.6844039555340735");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.852176, 6);
    ROMANO_ASSERT(f64_fmt_sz == 8, "f64_fmt_sz should be 8");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.852176", f64_fmt_sz) == 0, "fmt_f64(0.8521760814176254) should be 0.8521760814176254");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.1, 1);
    ROMANO_ASSERT(f64_fmt_sz == 3, "f64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.1", f64_fmt_sz) == 0, "fmt_f64(0.11855910715626328) should be 0.11855910715626328");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.5980291828562, 13);
    ROMANO_ASSERT(f64_fmt_sz == 15, "f64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.5980291828562", f64_fmt_sz) == 0, "fmt_f64(0.5980291828561546) should be 0.5980291828561546");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.9, 1);
    ROMANO_ASSERT(f64_fmt_sz == 3, "f64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.9", f64_fmt_sz) == 0, "fmt_f64(0.889426748158665) should be 0.889426748158665");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.35167755309458, 14);
    ROMANO_ASSERT(f64_fmt_sz == 16, "f64_fmt_sz should be 16");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.35167755309458", f64_fmt_sz) == 0, "fmt_f64(0.3516775530945794) should be 0.3516775530945794");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.172511063611754, 15);
    ROMANO_ASSERT(f64_fmt_sz == 17, "f64_fmt_sz should be 17");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.172511063611754", f64_fmt_sz) == 0, "fmt_f64(0.17251106361175395) should be 0.17251106361175395");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.1722698, 7);
    ROMANO_ASSERT(f64_fmt_sz == 9, "f64_fmt_sz should be 9");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.1722698", f64_fmt_sz) == 0, "fmt_f64(0.1722697993940605) should be 0.1722697993940605");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.8799, 4);
    ROMANO_ASSERT(f64_fmt_sz == 6, "f64_fmt_sz should be 6");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.8799", f64_fmt_sz) == 0, "fmt_f64(0.8799084597505504) should be 0.8799084597505504");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.835264403013, 12);
    ROMANO_ASSERT(f64_fmt_sz == 14, "f64_fmt_sz should be 14");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.835264403013", f64_fmt_sz) == 0, "fmt_f64(0.8352644030127814) should be 0.8352644030127814");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.2253289593311, 13);
    ROMANO_ASSERT(f64_fmt_sz == 15, "f64_fmt_sz should be 15");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.2253289593311", f64_fmt_sz) == 0, "fmt_f64(0.22532895933108887) should be 0.22532895933108887");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.8969035434492418, 16);
    ROMANO_ASSERT(f64_fmt_sz == 18, "f64_fmt_sz should be 18");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.8969035434492418", f64_fmt_sz) == 0, "fmt_f64(0.8969035434492418) should be 0.8969035434492418");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.15629389334, 11);
    ROMANO_ASSERT(f64_fmt_sz == 13, "f64_fmt_sz should be 13");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.15629389334", f64_fmt_sz) == 0, "fmt_f64(0.1562938933413015) should be 0.1562938933413015");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.2, 1);
    ROMANO_ASSERT(f64_fmt_sz == 3, "f64_fmt_sz should be 3");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.2", f64_fmt_sz) == 0, "fmt_f64(0.20622588037963463) should be 0.20622588037963463");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.10979537557, 11);
    ROMANO_ASSERT(f64_fmt_sz == 13, "f64_fmt_sz should be 13");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.10979537557", f64_fmt_sz) == 0, "fmt_f64(0.10979537557221364) should be 0.10979537557221364");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.35491097114489, 14);
    ROMANO_ASSERT(f64_fmt_sz == 16, "f64_fmt_sz should be 16");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.35491097114489", f64_fmt_sz) == 0, "fmt_f64(0.35491097114489434) should be 0.35491097114489434");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.8593528867604834, 16);
    ROMANO_ASSERT(f64_fmt_sz == 18, "f64_fmt_sz should be 18");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.8593528867604834", f64_fmt_sz) == 0, "fmt_f64(0.8593528867604834) should be 0.8593528867604834");
    f64_fmt_sz = fmt_f64(f64_buffer, 0.06, 2);
    ROMANO_ASSERT(f64_fmt_sz == 4, "f64_fmt_sz should be 4");
    ROMANO_ASSERT(memcmp(f64_buffer, "0.06", f64_fmt_sz) == 0, "fmt_f64(0.060724114411076724) should be 0.060724114411076724");

    return 0;
}
